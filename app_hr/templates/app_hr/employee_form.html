{% extends "app_hr/hr_base.html" %}

{% block title %}
  {% if mode == 'edit' %}
    แก้ไขพนักงาน {{ employee.code }}
  {% else %}
    เพิ่มพนักงานใหม่
  {% endif %}
{% endblock %}

{% block content %}
<div class="card-soft mb-3">
  <div class="card-soft-inner">

    <div class="d-flex flex-column flex-md-row justify-content-between gap-3 mb-3">
      <div>
        <span class="badge-pill pill-success mb-1">
          <i class="bi bi-person-vcard me-1"></i>
          {% if mode == 'edit' %}Employee{% else %}New Employee{% endif %}
        </span>

        <div class="page-title mb-0">
          {% if mode == 'edit' %}
            แก้ไขข้อมูลพนักงาน
          {% else %}
            เพิ่มพนักงานใหม่
          {% endif %}
        </div>

        {% if employee %}
          <div class="page-subtitle">
            {{ employee.code }} - {{ employee.first_name }} {{ employee.last_name }}
          </div>
        {% endif %}
      </div>

      <div class="d-flex flex-row gap-2 align-items-end">
        <a href="{% url 'app_hr:employee_list' %}" class="btn btn-outline-secondary btn-sm">
          <i class="bi bi-arrow-left me-1"></i> กลับไปหน้ารายการ
        </a>

        {% if employee %}
          <a href="{% url 'app_hr:employee_year_summary' employee.pk %}"
            class="btn btn-outline-success btn-sm">
            <i class="bi bi-graph-up me-1"></i> สรุปทั้งปี
          </a>

          <a href="{% url 'app_hr:tax_profile' %}?emp={{ employee.code }}"
            class="btn btn-outline-primary btn-sm">
            <i class="bi bi-cash-coin me-1"></i> สิทธิ์ลดหย่อนภาษี
          </a>
        {% endif %}
      </div>
    </div>

    <form method="post" class="mt-2">
      {% csrf_token %}
      <div class="row g-3">
        <div class="col-md-4">
          <label class="form-label small">รหัสพนักงาน</label>
          {{ form.code }}
        </div>
        <div class="col-md-4">
          <label class="form-label small">ชื่อ</label>
          {{ form.first_name }}
        </div>
        <div class="col-md-4">
          <label class="form-label small">นามสกุล</label>
          {{ form.last_name }}
        </div>

        <div class="col-md-4">
          <label class="form-label small">แผนก</label>
          {{ form.department }}
        </div>
        <div class="col-md-4">
          <label class="form-label small">ตำแหน่ง</label>
          {{ form.position }}
        </div>
        <div class="col-md-4">
          <label class="form-label small">ฐานเงินเดือน (บาท/เดือน)</label>
          {{ form.base_salary }}
        </div>

        <div class="col-md-4">
          <label class="form-label small">เบอร์โทรศัพท์</label>
          {{ form.phone_number }}
        </div>
        <div class="col-md-4">
          <label class="form-label small">วันที่เริ่มงาน</label>
          {{ form.hire_date }}
        </div>
        <div class="col-md-4">
          <label class="form-label small">สถานะ</label>
          {{ form.status }}
        </div>

        <div class="col-md-6">
          <label class="form-label small">ธนาคาร</label>
          {{ form.bank_name }}
        </div>
        <div class="col-md-6">
          <label class="form-label small">เลขบัญชีธนาคาร</label>
          {{ form.bank_account_no }}
        </div>

        <div class="col-md-6">
          <label class="form-label small">เลขบัตรประชาชน</label>
          {{ form.citizen_id }}
        </div>

        <div class="col-md-6">
          <label class="form-label small">ที่อยู่ติดต่อ</label>
          {{ form.address }}
        </div>
      </div>

      <div class="mt-4 d-flex gap-2">
        <button type="submit" class="btn btn-primary btn-sm">
          <i class="bi bi-save me-1"></i>
          {% if mode == 'edit' %}บันทึกการแก้ไข{% else %}บันทึกพนักงาน{% endif %}
        </button>
        <a href="{% url 'app_hr:employee_list' %}" class="btn btn-light btn-sm">
          ยกเลิก
        </a>
      </div>
    </form>

  </div>
</div>
{% endblock %}
